<!-- udacity2.0 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Exercise: Build and Deploy</title>
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/plyr.css">
  <link rel="stylesheet" href="../assets/css/katex.min.css">
  <link rel="stylesheet" href="../assets/css/jquery.mCustomScrollbar.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="shortcut icon" type="image/png" href="../assets/img/udacimak.png" />
</head>

<body>
  <div class="wrapper">
    <nav id="sidebar">
  <div class="sidebar-header">
    <h3>Containerization of an Existing Application</h3>
  </div>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled components">
    <li class="">
      <a href="01. Exercise Docker Based Apps.html">01. Exercise: Docker Based Apps</a>
    </li>
    <li class="">
      <a href="02. Install Packages.html">02. Install Packages</a>
    </li>
    <li class="">
      <a href="03. Copying an Application.html">03. Copying an Application</a>
    </li>
    <li class="">
      <a href="04. App Setup.html">04. App Setup</a>
    </li>
    <li class="">
      <a href="05. App Start.html">05. App Start</a>
    </li>
    <li class="">
      <a href="06. Exercise Build and Deploy.html">06. Exercise: Build and Deploy</a>
    </li>
    <li class="">
      <a href="07. Exercise Containerize an App.html">07. Exercise: Containerize an App</a>
    </li>
    <li class="">
      <a href="08. Summary.html">08. Summary</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>
</nav>

    <div id="content">
      <header class="container-fluild header">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="align-items-middle">
                <button type="button" id="sidebarCollapse" class="btn btn-toggle-sidebar">
                  <div></div>
                  <div></div>
                  <div></div>
                </button>

                <h1 style="display: inline-block">06. Exercise: Build and Deploy</h1>
              </div>
            </div>
          </div>
        </div>
      </header>

      <main class="container">
        <div class="row">
          <div class="col-12">
            <div class="ud-atom">
  <h3><p>Untitled</p></h3>
  <div>
  <h2 id="exercise-build-and-deploy">Exercise: Build and Deploy</h2>
<p>Now it's finally time to build our container and check out the deployed app!</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>ND9991 C04 L03 A06 Code Example</p></h3>
  <video controls>
  <source src="06. ND9991 C04 L03 A06 Code Example-EmF8l9Ew2i4.mp4" type="video/mp4">

  <track default="true" kind="subtitles" srclang="en" src="06. ND9991 C04 L03 A06 Code Example-EmF8l9Ew2i4.en.vtt" label="en">
</video>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Untitled</p></h3>
  <div>
  <h3 id="instructions">Instructions</h3>
<ul>
<li>Run <code>docker build --tag=api .</code> from the directory containing your <code>Dockerfile</code>. If you want to use a different tag name, feel free to do so.</li>
<li>Wait for awhile as your Docker image is built (<em>note:</em> you are welcome to get a jump start on the next exercise, if desired, while this completes).</li>
<li>Use <code>docker image ls</code> to make sure your new Docker image is shown. You won't see the other containers in Noah's video - those are all of his other Docker images on his computer.</li>
<li>Run <code>docker run -p 8000:5001 api</code>. If you changed the tag name in the first step, make sure to replace <code>api</code> here with your tag name.  Note above that the <code>-p</code> notes port 5001 from the Docker container (as specified in <code>web.py</code> for our flask app) is exposed on port 8000 on the host computer. </li>
<li>The container will tell us the Flask app is running on port 5001, but since we exposed port 8000 on our host to it, we will actually access the running app using port 8000. We haven't looked at Swagger documentation before here, but you can access it at <code>http://localhost:8000</code> in your browser when the docker container is running. Note that Swagger is part of the implementation of this specific Flask app - if you make your own Flask app, Swagger won't be included unless you include it in your own code.</li>
<li>Test out one of the Swagger commands from the running containerized app.</li>
<li>*HINT: * Remember that you can access the underlying container by opening up a web browser on your host machine and typing in <code>http://localhost:8000</code>.   The host container maps a port to the internal container and this is how the web service is exposed to your browser.</li>
</ul>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Untitled</p></h3>
  <div>
  <h3 id="more-on-swagger">More on Swagger</h3>
<p><a href="https://swagger.io/solutions/api-documentation/" rel="noopener noreferrer" target="_blank">Swagger</a> helps provide automated documentation for your APIs using the <a href="https://github.com/OAI/OpenAPI-Specification" rel="noopener noreferrer" target="_blank">OpenAPI specifications</a>. </p>
<p>Check out an example of a Swagger-based API <a href="https://petstore.swagger.io/#/" rel="noopener noreferrer" target="_blank">here</a>. Udacity actually uses Swagger for its internal-facing APIs!</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Exposing Docker ports</p></h3>
  <div>
  <form>
    <fieldset>
      <legend><p>Which of the following would allow you to look at a deployed Flask app that uses port 6001 by visiting <code>http://localhost:8080</code>?</p></legend>
    </fieldset>

      <div>
        <input type="radio" value="rbk1" name="900697" id="rbk1">
        <label for="rbk1"><p><code>docker run -p 6001:8080 my_app</code></p></label>
      </div>
      <div>
        <input type="radio" value="rbk2" name="900697" id="rbk2">
        <label for="rbk2"><p><code>docker run 8080:6001 my_app</code></p></label>
      </div>
      <div>
        <input type="radio" value="rbk3" name="900697" id="rbk3">
        <label for="rbk3"><p><code>docker run 6001:8080 my_app</code></p></label>
      </div>
      <div>
        <input type="radio" value="rbk4" name="900697" id="rbk4">
        <label for="rbk4"><p><code>docker run -p 8080:6001 my_app</code></p></label>
      </div>
  </form>

  <details>
    <summary><strong>SOLUTION:</strong></summary>
    `docker run -p 8080:6001 my_app`
  </details>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="code-example">Code Example</h3>
<ul>
<li>Data Engineering API Example by Noah: <a href="https://github.com/udacity/DevOps_Microservices/tree/master/Lesson-3-Containerization" rel="noopener noreferrer" target="_blank">LINK</a></li>
</ul>
<p>The <code>run_docker.py</code> file in the video is included below:</p>
<pre><code>#!/usr/bin/env bash

# Build image
docker build --tag=api .

# List docker images
docker image ls

# Run flask app
docker run -p 8000:5001 api</code></pre>
</div>

</div>
<div class="divider"></div>
          </div>

          <div class="col-12">
            <p class="text-right">
              <a href="07. Exercise Containerize an App.html" class="btn btn-outline-primary mt-4" role="button">Next Concept</a>
            </p>
          </div>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <p class="text-center">
                <a href="https://us-udacity.github.io/" target="_blank">【udacity2.0 】If you need more courses, please add wechat：udacity6</a>
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>


  <script src="../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../assets/js/plyr.polyfilled.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="../assets/js/katex.min.js"></script>
  <script>
    // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('06. Exercise: Build and Deploy')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
</body>

</html>
