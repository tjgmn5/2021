<!-- udacity2.0 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Lab - S3 &amp; Cloud Front</title>
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/plyr.css">
  <link rel="stylesheet" href="../assets/css/katex.min.css">
  <link rel="stylesheet" href="../assets/css/jquery.mCustomScrollbar.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="shortcut icon" type="image/png" href="../assets/img/udacimak.png" />
</head>

<body>
  <div class="wrapper">
    <nav id="sidebar">
  <div class="sidebar-header">
    <h3>Storage &amp; Content Delivery</h3>
  </div>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled components">
    <li class="">
      <a href="01. Lesson Introduction.html">01. Lesson Introduction</a>
    </li>
    <li class="">
      <a href="02. Why do we need storage in the cloud.html">02. Why do we need storage in the cloud?</a>
    </li>
    <li class="">
      <a href="03. S3 &amp; Glacier.html">03. S3 &amp; Glacier</a>
    </li>
    <li class="">
      <a href="04. S3 - Create a Bucket.html">04. S3 - Create a Bucket</a>
    </li>
    <li class="">
      <a href="05. DynamoDB.html">05. DynamoDB</a>
    </li>
    <li class="">
      <a href="06. DynamoDB - Create a table.html">06. DynamoDB - Create a table</a>
    </li>
    <li class="">
      <a href="07. Lab - DynamoDB.html">07. Lab - DynamoDB</a>
    </li>
    <li class="">
      <a href="08. Relational Database Service (RDS).html">08. Relational Database Service (RDS)</a>
    </li>
    <li class="">
      <a href="09. RDS - Create MySQL Database.html">09. RDS - Create MySQL Database</a>
    </li>
    <li class="">
      <a href="10. RedShift.html">10. RedShift</a>
    </li>
    <li class="">
      <a href="11. Lab - RDS.html">11. Lab - RDS</a>
    </li>
    <li class="">
      <a href="12. Why do we need content delivery in the cloud.html">12. Why do we need content delivery in the cloud?</a>
    </li>
    <li class="">
      <a href="13. Cloud Front.html">13. Cloud Front</a>
    </li>
    <li class="">
      <a href="14. Demo - Cloud Front.html">14. Demo - Cloud Front</a>
    </li>
    <li class="">
      <a href="15. Lab - S3 &amp; Cloud Front.html">15. Lab - S3 &amp; Cloud Front</a>
    </li>
    <li class="">
      <a href="16. Lesson Recap.html">16. Lesson Recap</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>
</nav>

    <div id="content">
      <header class="container-fluild header">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="align-items-middle">
                <button type="button" id="sidebarCollapse" class="btn btn-toggle-sidebar">
                  <div></div>
                  <div></div>
                  <div></div>
                </button>

                <h1 style="display: inline-block">15. Lab - S3 & Cloud Front</h1>
              </div>
            </div>
          </div>
        </div>
      </header>

      <main class="container">
        <div class="row">
          <div class="col-12">
            <div class="ud-atom">
  <h3></h3>
  <div>
  <h2 id="-s3--cloudfront"># S3 &amp; CloudFront</h2>
<p>In this hands-on exercise, you will access private S3 bucket content via a Cloud Front distribution. You will also learn that CloudFront, after caching, speeds up the delivery of content to your website.</p>
<ol>
<li>Prerequisites: AWS Account</li>
<li>By the end of this lab, you will be able to:</li>
</ol>
<ul>
<li>Create and configure a bucket</li>
<li>Upload an object to a bucket</li>
<li>Create distribution</li>
</ul>
<p>Follow the exercise instructions described below: </p>
<h3 id="step-1-create-s3-bucket">Step 1. Create S3 Bucket</h3>
<ul>
<li>From the <a href="https://console.aws.amazon.com/" rel="noopener noreferrer" target="_blank">AWS Management Console</a> page, select the S3 service.</li>
<li>Use the <strong>Create bucket</strong> wizard to create a bucket with the following details:</li>
</ul>
<p><center></p>
<table>
<thead>
<tr>
<th id="field">Field</th>
<th id="value">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bucket name</td>
<td>Your choice<br>Bucket name must be globally unique</td>
</tr>
<tr>
<td>Region</td>
<td>Default</td>
</tr>
<tr>
<td>Block all public access</td>
<td>Turn on<br>Block the public access.</td>
</tr>
<tr>
<td>Bucket Versioning</td>
<td>Disable</td>
</tr>
<tr>
<td>Server-side encryption</td>
<td>Disable</td>
</tr>
<tr>
<td></center></td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>Once the bucket is created, you will be taken to the <strong>Buckets</strong> dashboard. Click on the bucket name to view the details, and upload files and folders.</li>
</ul>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screenshot-2021-01-12-at-6.39.35-pm.png" alt="Click the &quot;Add files&quot; to upload a file" class="img img-fluid">
    <figcaption class="figure-caption">
      <p>Click the "Add files" to upload a file</p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="step-2-upload-object-to-bucket">Step 2. Upload Object to Bucket</h3>
<ul>
<li><p>Once the bucket is open to view its contents, click the <strong>Upload</strong> button to add files/folders.</p></li>
<li><p>Click the <strong>Add Files</strong> button, and upload the Sample.html (or any file from your local computer) provided at the bottom of the current page.</p></li>
<li><p>Note that the Bucket has not allowed public access, therefore, the <code>Sample.html</code> file cannot be accessed via its object URL, such as <code>https://my-014421265158-bucket.s3.us-east-2.amazonaws.com/Sample.html</code>. </p></li>
</ul>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <blockquote>
  <p><strong>Note</strong> - In the steps above, the object URL will be different in your case. </p>
</blockquote>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screenshot-2021-01-12-at-4.58.18-pm.png" alt="The figure above shows how to copy the S3 object URL. " class="img img-fluid">
    <figcaption class="figure-caption">
      <p>The figure above shows how to copy the S3 object URL. </p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screenshot-2021-01-12-at-5.00.45-pm.png" alt="The figure above shows &#x60;AccessDenied&#x60; error while trying to access the file via its S3 object URL" class="img img-fluid">
    <figcaption class="figure-caption">
      <p>The figure above shows <code>AccessDenied</code> error while trying to access the file via its S3 object URL</p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screenshot-2021-01-12-at-5.37.25-pm.png" alt="The figure above shows that the individual object (Sample.html) has no public access. " class="img img-fluid">
    <figcaption class="figure-caption">
      <p>The figure above shows that the individual object (Sample.html) has no public access. </p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="step-3-create-cloudfront-distribution">Step 3. Create CloudFront Distribution</h3>
<ul>
<li><p>Select the <strong>CloudFront</strong> service from the <strong>Services</strong> menu at the top left corner of your AWS console.</p></li>
<li><p>Start the <strong>Create Distribution</strong> wizard.</p></li>
<li><p>Under the <strong>Web</strong> delivery method, click the <strong>Get Started</strong> button, and use the following details to create a distribution:</p></li>
</ul>
<p><center></p>
<p></p>
<div class="index-module--table-responsive--1zG6k"><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><table class="index-module--table--8j68C index-module--table-striped--3HHC-">
<thead>
<tr>
<th>Section</th>
<th>Field</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr><td rowspan="5">Origin Settings</td><td>Origin Domain Name</td><td>Select the S3 bucket that you created in the step above</td></tr>
<tr><td>Origin Path</td><td>Enter <code>/</code> to indicate the root level</td></tr>
<tr><td>Restrict Bucket Access</td><td>Yes</td></tr>
<tr><td>Origin Access Identity</td><td>Create a New Identity<br>(Allow access to the S3 content using CloudFront URL)</td></tr>
<tr><td>Grant Read Permission on Bucket</td><td>Yes, Update Bucket Policy<br>Automatically updates the bucket access policy in S3<br> to allow CloudFront to access the bucket content</td></tr>
<tr><td>Default Cache Behavior Settings</td><td>Viewer Protocol Policy</td><td>Redirect HTTP to HTTPS</td></tr>
</tbody>
</table>
</div>
<p></p>
<p></center></p>
<blockquote>
  <p>In the configuration table above, the <strong>Grant Read Permission on Bucket</strong> says that "Yes, update access bucket policy automatically to allows the <strong>Origin Access Identity user</strong> access to the bucket content." Origin Access Identity user represents the CloudFront service.  The policy is a JSON file that defines the access permissions to the bucket object. </p>
</blockquote>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <ul>
<li>Leave the defaults for the rest of the options. It may take up to 10 minutes for the CloudFront Distribution to get created. Upon successful creation of the CloudFront distribution, the S3 bucket access policy will also get updated automatically, as shown below. </li>
</ul>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screenshot-2021-01-12-at-5.39.24-pm.png" alt="The figure above shows the updated S3 access policy.  We will learn more about the access policies in the upcoming lessons. " class="img img-fluid">
    <figcaption class="figure-caption">
      <p>The figure above shows the updated S3 access policy.  We will learn more about the access policies in the upcoming lessons. </p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <ul>
<li><p>Once your CloudFront distribution is created, and the status shows as <strong>Deployed</strong>, copy its <em>Domain Name</em> (such as, <code>dgf7z6g067r6d.cloudfront.net</code>) and append <code>/Sample.html</code> before pasting it in a new browser. </p></li>
<li><p>For the initial few attempts, your <code>https://dgf7z6g067r6d.cloudfront.net/Sample.html</code> may redirect to <code>https://my-014421265158-bucket.s3.us-east-2.amazonaws.com/Sample.html</code>, which is why you may still see an <code>AccessDenied</code> error. <br><br></p></li>
</ul>
<blockquote>
  <p><strong>Note</strong> - Remember, as soon as your CloudFront distribution is <strong>Deployed</strong>, it attaches to S3 and starts caching the S3 private pages. Once the caching is complete, the CloudFront domain name URL will stop redirecting to the S3 object URL. CloudFront may take 10-30 minutes (or more) to cache the S3 page, and you will be able to view the webpage, as shown below. </p>
</blockquote>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <blockquote>
  <p><strong>Note</strong> - In the steps above, the exact domain name and the object URL will be different in your case. </p>
</blockquote>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screenshot-2021-01-12-at-5.06.40-pm.png" alt="Final output at &#x60;https://dgf7z6g067r6d.cloudfront.net/Sample.html&#x60;. However, at the same time, the &#x60;https://my-014421265158-bucket.s3.us-east-2.amazonaws.com/Sample.html&#x60; will not work. " class="img img-fluid">
    <figcaption class="figure-caption">
      <p>Final output at <code>https://dgf7z6g067r6d.cloudfront.net/Sample.html</code>. However, at the same time, the <code>https://my-014421265158-bucket.s3.us-east-2.amazonaws.com/Sample.html</code> will not work. </p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="external-resources">External Resources</h3>
<ul>
<li>Good to read - <a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html#private-content-granting-permissions-to-oai" rel="noopener noreferrer" target="_blank">Restricting access to S3 content by using an Origin Access Identity</a></li>
</ul>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="step-4-delete-bucket-and-distribution">Step 4. Delete Bucket and Distribution</h3>
<ol>
<li><p><strong>Delete the CloudFront distribution</strong></p>
<ul>
<li><p>On the <strong>Distributions</strong> dashboard, click on the radio button next to the <strong>Delivery Method</strong> for the distribution. Click <strong>Disable</strong>, and confirm the prompt.<br><br></p></li>
<li><p>Once the distribution is disabled, you can delete it by selecting the radio button next to the <strong>Delivery Method</strong> and clicking the <strong>Delete</strong> button.<br><br></p></li>
<li><p>You may also need to delete the <strong>Origin Access Identity</strong> users. To do so, you can go to the <strong>Origin Access Identity</strong> service in the CloudFront dashboard. </p></li></ul></li>
</ol>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screenshot-2021-01-12-at-9.46.02-pm.png" alt="Delete OAI users" class="img img-fluid">
    <figcaption class="figure-caption">
      <p>Delete OAI users</p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <ol start="2">
<li><strong>Delete the S3 bucket</strong><ul>
<li>To delete the S3 bucket, navigate to the S3 service.<br><br></li>
<li>Select the radio button next to the name of the bucket you want to delete. Note that the bucket you want to delete should be empty before deletion.<br><br></li>
<li>Click the <strong>Delete</strong> button on the top-right, and confirm the deletion.</li></ul></li>
</ol>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Create a S3 bucket with a Cloud Front distribution</p></h3>
  <div>
  <div>
  </div>

  <form>
    <fieldset>
      <legend>Task List:</legend>

      <div>
        <input type="checkbox" id="58f2f105-06b4-407d-bfc3-4c648a4400fd--0">
        <label for="58f2f105-06b4-407d-bfc3-4c648a4400fd--0"><p>Create an S3 Bucket</p></label>
      </div>
      <div>
        <input type="checkbox" id="58f2f105-06b4-407d-bfc3-4c648a4400fd--1">
        <label for="58f2f105-06b4-407d-bfc3-4c648a4400fd--1"><p>Upload Object to your Bucket</p></label>
      </div>
      <div>
        <input type="checkbox" id="58f2f105-06b4-407d-bfc3-4c648a4400fd--2">
        <label for="58f2f105-06b4-407d-bfc3-4c648a4400fd--2"><p>Create CloudFront Distribution</p></label>
      </div>
      <div>
        <input type="checkbox" id="58f2f105-06b4-407d-bfc3-4c648a4400fd--3">
        <label for="58f2f105-06b4-407d-bfc3-4c648a4400fd--3"><p>Delete Bucket and Distribution</p></label>
      </div>
    </fieldset>
  </form>

  <div>
    <h4>Task Feedback:</h4>


    <p>Amazing Work!</p>
  </div>
</div>


</div>
<div class="divider"></div>
          </div>

          <div class="col-12">
            <p class="text-right">
              <a href="16. Lesson Recap.html" class="btn btn-outline-primary mt-4" role="button">Next Concept</a>
            </p>
          </div>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <p class="text-center">
                <a href="https://us-udacity.github.io/" target="_blank">【udacity2.0 】If you need more courses, please add wechat：udacity6</a>
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>


  <script src="../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../assets/js/plyr.polyfilled.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="../assets/js/katex.min.js"></script>
  <script>
    // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('15. Lab - S3 &amp; Cloud Front')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
</body>

</html>
